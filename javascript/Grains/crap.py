import numpy as np
import matplotlib.pyplot as plt
from convex_hull import compute_hull


s = [[0.09578153, 0.10036486, 0.11094063, 0.14795581, 0.15324369, 0.14901726, 0.13633796, 0.12788509, 0.1224049, 0.10596432, 0.09126847, 0.05452886, 0.0324851, 0.05885861, 0.07995742],[0.10596432, 0.07684629, 0.06714028, 0.06081368, 0.04816047, 0.04183387, 0.03698087, 0.02242187, -0.00669612, 0.00942203, 0.01479475, 0.0324851],[0.18097441, 0.20372697, 0.19775257, 0.16190613, 0.1380085, 0.13203409, 0.09795193, 0.08091085, 0.0774682, 0.06714028, 0.07037561, 0.09949364, 0.10596432, 0.1169247, 0.12788509, 0.15063766],[0.22681167, 0.23778917, 0.22075807, 0.20372697, 0.19614278, 0.12788509, 0.13211152, 0.15324369, 0.18892993, 0.22461617],[0.33637908, 0.31373584, 0.24580612, 0.24179764, 0.23778917, 0.23669142, 0.22461617, 0.23009863, 0.24654601, 0.26577222, 0.27274138, 0.33546379],[0.25900187, 0.24580612, 0.25335386, 0.2759971, 0.32128358, 0.33637908, 0.34268845, 0.39316343, 0.3994728, 0.40062105, 0.40406578, 0.40636226, 0.4007564, 0.38393879, 0.34949927, 0.29783998, 0.26340046],[0.52199826, 0.54184947, 0.53457125, 0.4690672, 0.45451074, 0.446486, 0.4304365, 0.41438701, 0.40636226, 0.3994728, 0.43377861, 0.45093152, 0.45664916, 0.46471509, 0.47278102, 0.48891289, 0.49552997],[0.26577222, 0.31646055, 0.32913264, 0.33847383, 0.39452097, 0.40386216, 0.40351754, 0.40248365, 0.38907968, 0.35556975, 0.33546379, 0.32849463, 0.32152547, 0.27971053],[0.4187333, 0.40248365, 0.40386216, 0.4197818, 0.45692763, 0.49450752, 0.5020235, 0.50748686, 0.53480363, 0.52333095, 0.50420981, 0.50038558, 0.48891289, 0.45664916, 0.4403995],[0.45664916, 0.40519044, 0.3994728, 0.38054468, 0.34899782, 0.33637908, 0.33592143, 0.33546379, 0.34216577, 0.3756757, 0.39578166, 0.40248365, 0.44581606, 0.45123261],[0.57763445, 0.60869032, 0.63223535, 0.68717374, 0.70287042, 0.70375871, 0.70642358, 0.69699608, 0.67814106, 0.63100352, 0.602721, 0.59329349, 0.59198857, 0.58807381, 0.58154921, 0.57893937],[0.57717541, 0.57338735, 0.58334042, 0.59329349, 0.65928604, 0.70642358, 0.71288274, 0.71934189, 0.72010734, 0.72240369, 0.7167463, 0.69411673, 0.68845934, 0.68051049, 0.62486853, 0.58512427],[0.54184947, 0.48891289, 0.50803403, 0.52715517, 0.53480363, 0.57763445, 0.59068365, 0.59329349, 0.58831696, 0.57836389, 0.57338735],[0.8120769, 0.82050736, 0.83286706, 0.84028288, 0.78151403, 0.77412523, 0.75195886, 0.72240369, 0.72202096, 0.71972461, 0.71934189, 0.76992462],[0.82508192, 0.82050736, 0.79521599, 0.72777234, 0.71934189, 0.71611231, 0.70965316, 0.70642358, 0.70553529, 0.70287042, 0.71123051, 0.7195906, 0.72878768, 0.78397015, 0.81156139, 0.81291345, 0.81696961, 0.82237782],[0.82050736, 0.82508192, 0.83405137, 0.91477642, 0.91436412, 0.91065335, 0.90982873, 0.89875359, 0.86220939, 0.84028288, 0.835339],[0.97068437, 1.01479475, 1.00673568, 0.99330388, 0.90982873, 0.91106565, 0.91271488, 0.91477642, 0.91726133, 0.91974625, 0.93672562],[0.82102576, 0.81156139, 0.81958936, 0.83163132, 0.83564531, 0.84298461, 0.85766321, 0.86500251, 0.89237438, 0.91974625, 0.91477642, 0.90580697, 0.82508192],[-0.0303048, -0.05133152, -0.0505035, -0.04967548, -0.02679814, 0.01895653, 0.04183387, 0.06714028, 0.08091085, 0.06649687, 0.0448759, 0.02062565, 0.00445882, -0.01979143],[0.07730735, 0.08091085, 0.10647247, 0.13203409, 0.13600071, 0.15186717, 0.15583378, 0.15492393, 0.1512845, 0.15037464, 0.14103744, 0.07567702, 0.0448759, 0.04847939],[0.28867114, 0.23344124, 0.20700073, 0.19818723, 0.18056023, 0.1755293, 0.15540557, 0.15037464, 0.15219435, 0.15583378, 0.16553813, 0.24317292, 0.25287727, 0.26182574],[0.25813886, 0.26340046, 0.30644986, 0.35810915, 0.38393879, 0.3658437, 0.36282785, 0.3537803, 0.34212806, 0.33047582, 0.32350837, 0.30260603, 0.29563858, 0.28867114, 0.2841969, 0.2573515, 0.25287727, 0.25708654],[0.14790055, 0.13203409, 0.16788053, 0.20372697, 0.21224252, 0.23778917, 0.24580612, 0.26340046, 0.25603423, 0.25287727, 0.17524248, 0.15583378],[0.46774617, 0.46803408, 0.4429375, 0.43457197, 0.41033447, 0.39417613, 0.36993863, 0.3537803, 0.36885954, 0.37790709, 0.38393879, 0.39515053, 0.40636226, 0.42241176, 0.45451074, 0.45765165, 0.46707437],[0.57717541, 0.57653122, 0.57395442, 0.57331022, 0.56445723, 0.52019229, 0.46707437, 0.46079255, 0.45451074, 0.46178897, 0.48362365, 0.54184947, 0.56550288, 0.57338735, 0.57528138],[0.57331022, 0.57685331, 0.57717541, 0.59307312, 0.66461279, 0.68845934, 0.68607025, 0.67890296, 0.64477342, 0.6277772, 0.61078098, 0.59975858],[0.59975858, 0.52964578, 0.52185547, 0.51288524, 0.46803408, 0.46765019, 0.46726631, 0.46707437, 0.47592735, 0.54675126, 0.57331022, 0.59535052],[0.73716013, 0.72492811, 0.71347744, 0.65049875, 0.64477342, 0.65046167, 0.66752644, 0.67890296, 0.68768318, 0.77548544, 0.79304589, 0.80182611, 0.79861045, 0.77288512, 0.76966945, 0.75341479],[0.80812129, 0.81107765, 0.80865067, 0.80182611, 0.75792498, 0.71402386, 0.67890296, 0.6800975, 0.68726479, 0.68845934, 0.7110889, 0.72240369, 0.74457006, 0.78151403],[0.80865067, 0.81107765, 0.81866444, 0.85659839, 0.90211913, 0.94429885, 0.95032452, 0.94991051, 0.94866848, 0.92639596, 0.90412345, 0.89669927, 0.8892751, 0.87315021, 0.82477555],[0.79038311, 0.78151403, 0.78886013, 0.80355234, 0.82559066, 0.84028288, 0.85490056, 0.89875359, 0.90211913, 0.89453234, 0.84142481, 0.81107765, 0.80516492],[1.04183387, 0.96557608, 0.95032452, 0.91417047, 0.90211913, 0.90127774, 0.89959497, 0.89875359, 0.90429116, 0.90982873, 0.91817624, 0.95991382, 0.96826133, 0.98495636, 0.99330388, 1.00300988, 1.01756888],[0.0448759, 0.07567702, 0.07050766, 0.06533829, 0.0564847, 0.01221674, -0.02319762, -0.02149453, -0.02115391, -0.01979143, 0.02870907, 0.03679248],[-0.02609262, -0.03095308, -0.02707535, -0.02319762, 0.00336315, 0.04763111, 0.06533829, 0.10026455, 0.11190663, 0.11208141, 0.10819375, 0.09653074, 0.04466207, 0.02737252, 0.02251205, 0.00793065],[0.07698037, 0.06533829, 0.06878453, 0.07567702, 0.09435143, 0.11302583, 0.15037464, 0.16546744, 0.18056023, 0.1748391, 0.16911797, 0.11762777, 0.11190663],[0.23344124, 0.28867114, 0.33047582, 0.34177831, 0.34460393, 0.36438328, 0.35068344, 0.32237126, 0.31293386, 0.2563095, 0.2391583],[0.11190663, 0.18056023, 0.18937373, 0.23344124, 0.25059244, 0.2563095, 0.25314375, 0.24364649, 0.21690658, 0.19943572, 0.13828771, 0.11208141],[0.37688472, 0.36196517, 0.34704562, 0.33709925, 0.33025874, 0.30973723, 0.29605623, 0.29081525, 0.26461038, 0.24888746, 0.24364649, 0.24997799, 0.2563095, 0.28462168, 0.30349647, 0.35068344, 0.36050892],[0.47700431, 0.52185547, 0.51743765, 0.51655408, 0.46859707, 0.45261139, 0.43750841, 0.43247408, 0.43352302, 0.43430973, 0.43457197, 0.45130302, 0.46803408],[0.36438328, 0.36155765, 0.33330144, 0.33047582, 0.34795418, 0.3537803, 0.36185947, 0.43457197, 0.4340475, 0.43273632, 0.43247408, 0.38991733],[0.36378408, 0.35068344, 0.3541084, 0.36095832, 0.36438328, 0.39842868, 0.43247408, 0.44254274, 0.44757707, 0.45261139, 0.45453065, 0.46796541, 0.47180391, 0.46292295, 0.45431912, 0.40269618, 0.38548854, 0.37688472],[0.54543838, 0.52856851, 0.50018621, 0.48126467, 0.47180391, 0.46604615, 0.45261139, 0.50856124, 0.51655408, 0.52196685, 0.55444344, 0.5598562, 0.55625175],[0.60373816, 0.5598562, 0.52737961, 0.51655408, 0.51920477, 0.5209719, 0.52185547, 0.56080702, 0.57638764, 0.59196827, 0.59975858, 0.61078098, 0.61019408, 0.60608577],[0.64477342, 0.6734001, 0.71920278, 0.72492811, 0.71764519, 0.65938179, 0.65209886, 0.61985839, 0.60373816, 0.60491196, 0.60549886, 0.60960717, 0.61078098, 0.63627531],[0.65209886, 0.65253115, 0.65512486, 0.65555714, 0.64086292, 0.6188216, 0.61147449, 0.59496546, 0.55369289, 0.54543838, 0.5472406, 0.55805397, 0.5598562, 0.56716986, 0.5964245, 0.60373816, 0.61179828, 0.64403874],[0.76966945, 0.84772873, 0.84130396, 0.82631283, 0.82202965, 0.80421126, 0.75966528, 0.75075608, 0.73942612, 0.73716013, 0.74528746],[0.65209886, 0.72492811, 0.73716013, 0.73829313, 0.74169212, 0.7473571, 0.74962309, 0.75075608, 0.74331008, 0.72097205, 0.70461832, 0.6882646, 0.66373401, 0.65555714, 0.653828],[0.81671311, 0.8892751, 0.88788958, 0.88096195, 0.87819089, 0.87057535, 0.84772873, 0.83211687, 0.79308723, 0.77747538, 0.76966945, 0.78253211, 0.79217911, 0.80182611, 0.80523839, 0.80865067],[0.90722679, 0.87819089, 0.88511852, 0.8892751, 0.9412443, 0.94866848, 0.97495189, 0.98020857, 0.97816486, 0.97680238, 0.96904692, 0.9526548, 0.93626269],[0.98362832, 1.02737252, 1.02125707, 1.01514161, 0.99704877, 0.9699095, 0.92467738, 0.91021069, 0.89574401, 0.89912056, 0.90925023, 0.92275646, 0.93288613, 0.93626269, 0.94445875, 0.96904692],[0.84772873, 0.87819089, 0.91448577, 0.92900372, 0.93626269, 0.92950958, 0.89574401, 0.8863677, 0.8394862, 0.82639378, 0.82202965, 0.82417124, 0.8327376],[0.08508696, 0.06936313, 0.05549181, 0.04162049, 0.03941391, 0.02176133, 0.01514161, 0.02737252, 0.0360173, 0.08788596, 0.09653074, 0.10821407, 0.11210851, 0.12768628, 0.13547516, 0.13043634, 0.0951646],[0.11735905, 0.08508696, 0.09012578, 0.10524224, 0.13547516, 0.14375596, 0.18515996, 0.18876822, 0.19959299, 0.19295934, 0.18411447, 0.18190325, 0.17383522, 0.15769918],[0.19468395, 0.18515996, 0.15203676, 0.13547516, 0.13158072, 0.09653074, 0.10041841, 0.11208141, 0.17322943, 0.20817115, 0.21690658, 0.21373192],[0.27392591, 0.25922543, 0.22457412, 0.19858564, 0.18992281, 0.18190325, 0.18632568, 0.19517055, 0.19738177, 0.19959299, 0.2167349, 0.25101873, 0.25958969, 0.26816064, 0.2693137, 0.27277286],[0.30624055, 0.27392591, 0.27334938, 0.2716198, 0.26816064, 0.28210843, 0.29140696, 0.29605623, 0.33709925, 0.3659909, 0.37562145, 0.37401784, 0.3734833, 0.36507796, 0.33986193],[0.24364649, 0.29605623, 0.27280991, 0.26816064, 0.24244777, 0.20816394, 0.19959299, 0.19237647, 0.18515996, 0.19150928, 0.21055725, 0.21690658, 0.22359155],[0.46292295, 0.47180391, 0.50964697, 0.52856851, 0.53632734, 0.53943087, 0.5425344, 0.54408616, 0.53786611, 0.50054578, 0.49432572, 0.48277709, 0.45390551, 0.4481312, 0.45182913, 0.4536781, 0.45922501],[0.4481312, 0.47700278, 0.48855141, 0.49432572, 0.49341316, 0.4925006, 0.49067547, 0.48165656, 0.42754313, 0.40950531, 0.40048641, 0.39373563, 0.3734833, 0.37455237, 0.37562145, 0.38468517, 0.42094004],[0.33709925, 0.35699198, 0.37191153, 0.37688472, 0.4457153, 0.46292295, 0.44998017, 0.4481312, 0.43000376, 0.39374888, 0.37562145, 0.37080617, 0.35154507, 0.34191452],[0.72097205, 0.71752153, 0.71062048, 0.70305866, 0.68037321, 0.65012595, 0.63500231, 0.6271597, 0.61735644, 0.61539579, 0.61147449, 0.63351581, 0.65555714, 0.67191087, 0.71279519],[0.49432572, 0.54408616, 0.5612427, 0.6127123, 0.62986883, 0.63078009, 0.63169134, 0.62017401, 0.60289801, 0.59713934, 0.58817023, 0.56126288, 0.52538643, 0.49501434, 0.49067547, 0.49158803],[0.52856851, 0.53700344, 0.54543838, 0.5619474, 0.60321997, 0.61147449, 0.6193171, 0.62912036, 0.63304166, 0.63500231, 0.62986883, 0.62129056, 0.56982096, 0.55266443, 0.54408616, 0.5332238, 0.53012027],[0.71062048, 0.7720012, 0.76339229, 0.75191374, 0.7490441, 0.71976996, 0.6404992, 0.63169134, 0.63123571, 0.62986883, 0.63500231, 0.64256413, 0.69549684],[0.7720012, 0.81972646, 0.83220479, 0.86963977, 0.86185917, 0.83851738, 0.81368098, 0.79712338, 0.78884458, 0.78221116, 0.7490441, 0.75765301, 0.76626192],[0.7720012, 0.76586312, 0.72289662, 0.71062048, 0.714071, 0.71579626, 0.72097205, 0.75075608, 0.76857447, 0.81312045, 0.82202965, 0.8394862, 0.8320763, 0.82219643, 0.81972646],[0.92691172, 0.92467738, 0.94277023, 1.01514161, 1.01734819, 1.02396791, 1.04162049, 1.03527872, 1.02626883, 1.01725893, 0.95418967, 0.92715998],[0.83454626, 0.8394862, 0.8769914, 0.89574401, 0.91744404, 0.92467738, 0.92567042, 0.92666346, 0.92715998, 0.92363727, 0.92011455, 0.91170209, 0.90328962, 0.87805223, 0.86963977, 0.8634006, 0.82596562, 0.81972646, 0.82466639],[0.15705239, 0.21537679, 0.20967673, 0.19257655, 0.18117643, 0.16330036, 0.10967214, 0.09726649, 0.07865802, 0.0724552, 0.07328414, 0.07659993, 0.07742888, 0.08254794, 0.09278606, 0.09790512],[0.1611612, 0.15705239, 0.14719451, 0.13733664, 0.09790512, 0.09552662, 0.08363412, 0.08125562, 0.06936313, 0.07722504, 0.08508696, 0.10122301, 0.10929103, 0.14963115, 0.18190325, 0.18992281, 0.17759641],[-0.04362237, -0.04655682, -0.03339784, -0.02681834, -0.00707986, 0.04362539, 0.06897801, 0.07742888, 0.07577099, 0.0724552, 0.04391881, 0.03440668, 0.02575347, 0.00844705, -0.034819, -0.03775346],[0.09790512, 0.07742888, 0.01827276, 0.00137101, -0.00707986, -2.01e-05, 0.03527872, 0.03844961, 0.04162049, 0.06242747, 0.06936313, 0.07649863],[0.15705239, 0.18992281, 0.2159113, 0.2505626, 0.25922543, 0.25564159, 0.24130621, 0.23772236, 0.23213597, 0.21537679, 0.19787947, 0.16288483],[0.25922543, 0.27392591, 0.28200457, 0.29816189, 0.30624055, 0.31311629, 0.34061925, 0.34749499, 0.33715048, 0.32680596, 0.31646144, 0.24559627, 0.23772236, 0.23951428, 0.25384966],[0.44492877, 0.408265, 0.40670928, 0.40593142, 0.40048641, 0.43656203, 0.49067547, 0.50369208, 0.52104756, 0.52538643, 0.50534206, 0.4977904, 0.48268707],[0.31646144, 0.34232273, 0.34749499, 0.35509124, 0.37788, 0.408265, 0.41743095, 0.44492877, 0.44402408, 0.44221469, 0.43769121, 0.43497712, 0.43407242, 0.41568926, 0.3421566, 0.32377343, 0.32194543],[0.30624055, 0.31464589, 0.35667261, 0.3734833, 0.38023408, 0.40048641, 0.40515357, 0.408265, 0.40066875, 0.3626875, 0.34749499, 0.34405712, 0.31655416],[0.61171855, 0.6457367, 0.6257793, 0.5858645, 0.56590709, 0.56227377, 0.54804084, 0.50534206, 0.50868278, 0.5220457, 0.52538643, 0.53435554, 0.57920111, 0.59713934],[0.68658152, 0.68356438, 0.66465054, 0.6457367, 0.64087696, 0.62629775, 0.61657828, 0.60199907, 0.59713934, 0.62593267, 0.63169134, 0.65811493, 0.69334638, 0.7109621, 0.71976996, 0.70770144],[0.83851738, 0.84991731, 0.87841713, 0.88411709, 0.87782984, 0.86525533, 0.84824085, 0.83122638, 0.78018295, 0.78104911, 0.78191527, 0.78537992, 0.78797841, 0.78884458, 0.83023858],[0.78018295, 0.77462433, 0.726861, 0.698203, 0.69454334, 0.68356438, 0.7046843, 0.71976996, 0.7270885, 0.74172557, 0.7490441, 0.75567751, 0.76231093, 0.78884458, 0.78278144],[0.88411709, 0.93750207, 0.94547263, 0.95344318, 0.95491041, 0.96077932, 0.965181, 0.93985601, 0.92086227, 0.90186852, 0.88813857, 0.86983198, 0.86525533, 0.86839895],[0.86963977, 0.92011455, 0.92533081, 0.93228582, 0.93402457, 0.93750207, 0.92860458, 0.91970708, 0.89301459, 0.88411709, 0.86131723, 0.83851738, 0.85018827, 0.85796887],[0.92011455, 0.92715998, 0.94517977, 0.98121935, 1.03527872, 1.02821896, 1.0211592, 1.00350979, 0.99292014, 0.98634065, 0.95344318, 0.93750207, 0.92359205, 0.9218533],[-0.01037084, -0.01610384, -0.01105279, -0.00095069, 0.03440668, 0.0724552, 0.10967214, 0.10931748, 0.10848993, 0.10036486, 0.0980732, 0.09578153, 0.07808947, 0.01616725],[-0.02931563, -0.01794876, -0.01037084, 0.00732122, 0.06924344, 0.09578153, 0.08523213, 0.04830921, 0.0377598, 0.0324851, 0.02363993, 0.01479475, 0.00744302, -0.0219639],[0.15324369, 0.14266792, 0.10565274, 0.10036486, 0.10442739, 0.10848993, 0.11770264, 0.21904248, 0.24310807, 0.24654601, 0.24106355, 0.22461617, 0.18000837],[0.22216711, 0.22672163, 0.22288206, 0.21904248, 0.20061706, 0.19140434, 0.15455349, 0.12691535, 0.10848993, 0.10860815, 0.10908103, 0.10919925, 0.10967214, 0.11861017, 0.17223839, 0.18117643, 0.20394903],[0.32309992, 0.32913264, 0.3227966, 0.29111639, 0.27210826, 0.26577222, 0.25615911, 0.24654601, 0.23279424, 0.21904248, 0.22480184, 0.22672163, 0.23425043, 0.26436561, 0.31706719, 0.31827374],[0.18573095, 0.18117643, 0.21537679, 0.22654957, 0.23772236, 0.2770919, 0.29283972, 0.30858753, 0.31646144, 0.32011744, 0.32377343, 0.32042031, 0.31706719, 0.3095384, 0.28695201, 0.22672163],[0.54329654, 0.56227377, 0.55725292, 0.52210693, 0.50704436, 0.5020235, 0.48699154, 0.47947556, 0.45692763, 0.45121383, 0.43978622, 0.43407242, 0.43588181, 0.44492877, 0.47513541, 0.50534206],[0.41447526, 0.40386216, 0.34781502, 0.32913264, 0.32792609, 0.325513, 0.31706719, 0.32377343, 0.33296501, 0.40649767, 0.43407242, 0.44550003, 0.45692763, 0.44631454, 0.44100799],[0.63093302, 0.56590709, 0.61247436, 0.6457367, 0.65519362, 0.68356438, 0.68722404, 0.698203, 0.67393651, 0.65794038, 0.65260833],[0.5020235, 0.56227377, 0.56590709, 0.5731322, 0.61648282, 0.62370792, 0.65260833, 0.62625753, 0.60869032, 0.59316239, 0.58539842, 0.57763445, 0.56335751, 0.5419421, 0.53480363, 0.52387692],[0.65260833, 0.67393651, 0.68698172, 0.70002692, 0.70589603, 0.7137215, 0.7195906, 0.71541056, 0.70705047, 0.70287042, 0.61653866, 0.60869032, 0.62186572],[0.71567786, 0.70002692, 0.70891642, 0.73558492, 0.77114291, 0.7800324, 0.7889219, 0.79476233, 0.82396446, 0.83564531, 0.82761734, 0.81557538, 0.81156139, 0.80236431, 0.77477308, 0.7195906],[0.67393651, 0.67595871, 0.69213637, 0.69415858, 0.698203, 0.70775566, 0.75551899, 0.77462433, 0.78177312, 0.78713471, 0.7889219, 0.76225341, 0.70002692, 0.68045911],[0.98962916, 0.98015677, 0.97068437, 0.96219468, 0.94521531, 0.92823593, 0.91974625, 0.90801544, 0.88064357, 0.86891277, 0.86500251, 0.87274538, 0.88823112, 0.89597399, 0.9047662, 0.92235064, 0.95751951, 0.97510394, 0.98389616],[0.77462433, 0.78018295, 0.85674809, 0.86525533, 0.87440863, 0.89729187, 0.90186852, 0.90039489, 0.89597399, 0.86500251, 0.83564531, 0.80644318, 0.7889219, 0.77641152],[0.99114063, 1.03440668, 1.02430458, 1.01925353, 0.98389616, 0.96631172, 0.91355842, 0.89597399, 0.89892125, 0.90186852, 0.91453102, 0.95884975, 0.965181, 0.97383421]];

t = [[-0.03377357, -0.03543897, -0.01869401, 0.03991336, 0.04828584, 0.05604971, 0.07934131, 0.09486904, 0.09667223, 0.1020818, 0.09289239, 0.06991885, 0.05613472, 0.01867293, -0.0112965],[0.1020818, 0.17629118, 0.20102763, 0.19971399, 0.19708669, 0.19577304, 0.18927439, 0.16977843, 0.13078651, 0.07694378, 0.0589962, 0.05613472],[0.13832035, 0.15694235, 0.16317192, 0.20054936, 0.22546765, 0.23169722, 0.22128187, 0.21607419, 0.21231255, 0.20102763, 0.19278215, 0.11857277, 0.1020818, 0.09847542, 0.09486904, 0.11349103],[0.05315973, 0.15269728, 0.15481982, 0.15694235, 0.15073502, 0.09486904, 0.08710517, 0.04828584, 0.04076903, 0.03325223],[0.0832805, 0.10153233, 0.1562878, 0.15449254, 0.15269728, 0.14274353, 0.03325223, 0.02689383, 0.00781865, 0.00953455, 0.01568058, 0.07099483],[0.17639889, 0.1562878, 0.15020386, 0.13195203, 0.09544838, 0.0832805, 0.08969822, 0.14104001, 0.14745774, 0.15414216, 0.17419541, 0.18756425, 0.19197351, 0.20520128, 0.19888737, 0.1894165, 0.18310258],[0.10237458, 0.1233852, 0.12990211, 0.18855427, 0.20158808, 0.19925078, 0.19457617, 0.18990156, 0.18756425, 0.14745774, 0.10010892, 0.07643451, 0.06854305, 0.0682465, 0.06794996, 0.06735688, 0.07436042],[0.00953455, -0.0322584, -0.04270664, -0.03913501, -0.01770522, -0.01413358, -0.00872461, 0.00750233, 0.02020083, 0.05194708, 0.07099483, 0.06484881, 0.05870278, 0.02182661],[0.02581455, 0.00750233, -0.01413358, -0.03233799, -0.07481493, -0.07192914, -0.07135198, -0.06374871, -0.02573237, -0.00246005, 0.03632713, 0.04408457, 0.06735688, 0.06854305, 0.05023083],[0.06854305, 0.13956627, 0.14745774, 0.12820457, 0.09611595, 0.0832805, 0.07713767, 0.07099483, 0.06464558, 0.03289933, 0.01385158, 0.00750233, 0.0563349, 0.06243897],[-0.00962139, -0.0184567, -0.0062846, 0.02211697, 0.03023171, 0.03693829, 0.05705805, 0.06002484, 0.06595841, 0.08079233, 0.08969268, 0.09265946, 0.08413606, 0.05856585, 0.01594883, -0.00109798],[0.13132182, 0.12562997, 0.10914471, 0.09265946, 0.07189197, 0.05705805, 0.06551028, 0.0739625, 0.09230689, 0.14734007, 0.1530421, 0.1758502, 0.18155222, 0.17796434, 0.15284914, 0.13490971],[0.1233852, 0.06735688, 0.02856969, -0.01021749, -0.02573237, -0.00962139, 0.07561265, 0.09265946, 0.10090209, 0.11738734, 0.12562997],[0.06154354, 0.06041455, 0.10813835, 0.13677264, 0.16763168, 0.16509523, 0.15748588, 0.14734007, 0.13816788, 0.0831347, 0.0739625, 0.06718852],[0.05436075, 0.06041455, 0.06380154, 0.07283351, 0.0739625, 0.06973639, 0.06128417, 0.05705805, 0.05035147, 0.03023171, 0.0137774, -0.0026769, -0.00589889, -0.02523079, -0.03489674, -0.02597099, 0.00080626, 0.03650925],[0.06041455, 0.05436075, 0.05308871, 0.04164043, 0.05035176, 0.12875368, 0.14617633, 0.15831448, 0.14485083, 0.13677264, 0.11768312],[0.02865975, 0.0589962, 0.08591757, 0.13078651, 0.14617633, 0.12004235, 0.08519706, 0.04164043, 0.03893407, 0.0362277, 0.03370505],[0.0275835, -0.03489674, -0.04840174, -0.06865923, -0.07541173, -0.07627646, -0.07800591, -0.07887063, -0.02132147, 0.0362277, 0.04164043, 0.04291247, 0.05436075],[0.30245868, 0.28105332, 0.26362602, 0.24619873, 0.2335923, 0.20837946, 0.19577304, 0.20102763, 0.21607419, 0.25234621, 0.30675423, 0.30915691, 0.31075869, 0.31316136],[0.22514219, 0.21607419, 0.2238857, 0.23169722, 0.23798833, 0.26315275, 0.26944386, 0.27825158, 0.31348244, 0.32229016, 0.32498336, 0.34383573, 0.30675423, 0.29768623],[0.31266613, 0.37851183, 0.37205292, 0.36989995, 0.365594, 0.3583767, 0.32950747, 0.32229016, 0.30467473, 0.26944386, 0.26889893, 0.26453951, 0.26399459, 0.27616247],[0.22354858, 0.18310258, 0.19099497, 0.20046584, 0.20520128, 0.25962469, 0.26869526, 0.29590696, 0.30443963, 0.31297229, 0.31292127, 0.31276819, 0.31271716, 0.31266613, 0.30658219, 0.27007853, 0.26399459, 0.23163779],[0.25686165, 0.23169722, 0.19431978, 0.15694235, 0.15588108, 0.15269728, 0.1562878, 0.18310258, 0.23972699, 0.26399459, 0.26835401, 0.26944386],[0.28085887, 0.30773089, 0.32171716, 0.32637925, 0.31723757, 0.31114311, 0.30200142, 0.29590696, 0.25055412, 0.22334241, 0.20520128, 0.19638276, 0.18756425, 0.19223886, 0.20158808, 0.20573043, 0.2181575],[0.13132182, 0.15124243, 0.23092485, 0.25084545, 0.24812146, 0.23450148, 0.2181575, 0.20987279, 0.20158808, 0.19507117, 0.17552045, 0.1233852, 0.12506877, 0.12562997, 0.12847589],[0.25084545, 0.14128212, 0.13132182, 0.13849759, 0.17078856, 0.18155222, 0.19714896, 0.24393919, 0.28331689, 0.28629768, 0.28927846, 0.28606546],[0.28606546, 0.32741403, 0.33200831, 0.32796208, 0.30773089, 0.27190153, 0.23607218, 0.2181575, 0.22088149, 0.24267346, 0.25084545, 0.28019545],[0.38129587, 0.37810385, 0.36456286, 0.29008739, 0.28331689, 0.27675394, 0.25706509, 0.24393919, 0.24597936, 0.2663811, 0.27046145, 0.27250163, 0.28197505, 0.35776246, 0.36723588, 0.37426588],[0.25079241, 0.2600325, 0.26758376, 0.27250163, 0.26230076, 0.25209989, 0.24393919, 0.23614082, 0.18935059, 0.18155222, 0.15874412, 0.14734007, 0.15494942, 0.16763168],[0.26758376, 0.2600325, 0.25449005, 0.22677782, 0.19352315, 0.23961428, 0.24619873, 0.25491238, 0.28105332, 0.2934435, 0.30583367, 0.30996373, 0.31409378, 0.30479178, 0.27688577],[0.19535193, 0.16763168, 0.1637743, 0.15605954, 0.1444874, 0.13677264, 0.1421581, 0.15831448, 0.19352315, 0.1990656, 0.23786272, 0.2600325, 0.24155233],[0.19577304, 0.23779445, 0.24619873, 0.20669205, 0.19352315, 0.18472099, 0.16711665, 0.15831448, 0.1522454, 0.14617633, 0.14463734, 0.13694243, 0.13540345, 0.13232549, 0.13078651, 0.14378381, 0.16327977],[0.30675423, 0.34383573, 0.36483773, 0.38583974, 0.38766156, 0.39677065, 0.40405792, 0.35860964, 0.34951998, 0.31316136, 0.30835601, 0.30755512],[0.42208368, 0.41429289, 0.4091754, 0.40405792, 0.39859246, 0.38948337, 0.38583974, 0.43098832, 0.44603784, 0.46231578, 0.46779632, 0.48423792, 0.50189621, 0.5077823, 0.49999152, 0.47661917],[0.40088926, 0.38583974, 0.3718384, 0.34383573, 0.33844933, 0.33306294, 0.32229016, 0.34394208, 0.365594, 0.37229766, 0.37900131, 0.43933419, 0.44603784],[0.37851183, 0.31266613, 0.31297229, 0.34613371, 0.35442406, 0.41245654, 0.43781044, 0.44002525, 0.44076352, 0.44519313, 0.39518215],[0.44603784, 0.365594, 0.36774697, 0.37851183, 0.42852281, 0.44519313, 0.45184972, 0.47181947, 0.48366243, 0.48010466, 0.46765245, 0.46231578],[0.49528421, 0.51832519, 0.54136616, 0.55672681, 0.55656172, 0.55606643, 0.55573623, 0.54734456, 0.50538618, 0.48021115, 0.47181947, 0.4585063, 0.44519313, 0.44297832, 0.44150178, 0.43781044, 0.4593631],[0.31177712, 0.33200831, 0.37393255, 0.3823174, 0.40228234, 0.40893732, 0.39942037, 0.39624805, 0.36131365, 0.33511285, 0.32637925, 0.31705507, 0.30773089],[0.41245654, 0.40416619, 0.32126265, 0.31297229, 0.30017329, 0.29590696, 0.29895419, 0.32637925, 0.34384645, 0.38751445, 0.39624805, 0.40637836],[0.46654733, 0.43781044, 0.43147196, 0.41879501, 0.41245654, 0.40435229, 0.39624805, 0.40259268, 0.405765, 0.40893732, 0.41807816, 0.48206405, 0.50034573, 0.50620445, 0.50511243, 0.49856029, 0.49637624, 0.49528421],[0.49068508, 0.50126516, 0.50080545, 0.50049897, 0.50034573, 0.47292321, 0.40893732, 0.38564489, 0.3823174, 0.3880724, 0.42260242, 0.42835743, 0.44393934],[0.40421724, 0.42835743, 0.39382741, 0.3823174, 0.35716286, 0.34039316, 0.33200831, 0.30903688, 0.29984831, 0.29065974, 0.28606546, 0.28927846, 0.29885669, 0.36590431],[0.28331689, 0.31716937, 0.37133335, 0.37810385, 0.38277411, 0.42013619, 0.42480645, 0.41108031, 0.40421724, 0.38506077, 0.37548254, 0.30843493, 0.28927846, 0.28480728],[0.42480645, 0.43245881, 0.478373, 0.48602536, 0.49433156, 0.50679085, 0.51094394, 0.50587923, 0.49321744, 0.49068508, 0.48289412, 0.43614838, 0.42835743, 0.42433406, 0.4082406, 0.40421724, 0.40764877, 0.42137491],[0.36723588, 0.40033362, 0.42725955, 0.4900867, 0.50803731, 0.50421804, 0.49466985, 0.49276021, 0.39987326, 0.38129587, 0.37778087],[0.42480645, 0.37810385, 0.38129587, 0.39058457, 0.41845065, 0.46489412, 0.48347151, 0.49276021, 0.49775149, 0.51272533, 0.50605034, 0.49937535, 0.48936286, 0.48602536, 0.45541591],[0.27223476, 0.31409378, 0.32364984, 0.37143011, 0.39054221, 0.39299007, 0.40033362, 0.39371408, 0.37716521, 0.37054566, 0.36723588, 0.32934218, 0.3009219, 0.27250163, 0.27004269, 0.26758376],[0.40490121, 0.39054221, 0.34276194, 0.31409378, 0.28518338, 0.28105332, 0.30781002, 0.31316136, 0.3676993, 0.40405792, 0.41429289, 0.41677655, 0.4192602],[0.43766524, 0.5077823, 0.51911135, 0.53044039, 0.53307597, 0.53702933, 0.54361826, 0.5339738, 0.52432934, 0.51557358, 0.48930629, 0.45428324, 0.42801596, 0.4192602, 0.41801837, 0.41429289],[0.40033362, 0.39054221, 0.40849095, 0.41567045, 0.4192602, 0.43677172, 0.52432934, 0.52475297, 0.52687111, 0.51274576, 0.50803731, 0.499062, 0.46316077],[0.63459252, 0.64003895, 0.63623764, 0.63243632, 0.62393666, 0.55593938, 0.53044039, 0.5077823, 0.50483925, 0.48718096, 0.48423792, 0.5071105, 0.51473469, 0.54523147, 0.56047986, 0.56789113, 0.61976999],[0.64334365, 0.63459252, 0.62718125, 0.60494745, 0.56047986, 0.56124034, 0.56504275, 0.56955601, 0.58309579, 0.61225208, 0.65112714, 0.6608459, 0.65865812, 0.65428256],[0.54062866, 0.56504275, 0.56200083, 0.56047986, 0.55285567, 0.48423792, 0.47875738, 0.46231578, 0.47476799, 0.48188354, 0.48366243, 0.49180046],[0.67777073, 0.68487039, 0.67836522, 0.67348634, 0.67186004, 0.6608459, 0.64140838, 0.60253332, 0.59281455, 0.58309579, 0.58384204, 0.58533455, 0.58570768, 0.58608081, 0.60441879, 0.65943274],[0.68360951, 0.67777073, 0.66860173, 0.64109476, 0.58608081, 0.57090852, 0.56079366, 0.55573623, 0.55672681, 0.5964312, 0.609666, 0.63864551, 0.64830535, 0.65271837, 0.66595743],[0.47181947, 0.55573623, 0.58102338, 0.58608081, 0.58496143, 0.58346892, 0.58309579, 0.57406927, 0.56504275, 0.54876669, 0.4999385, 0.48366243, 0.48070169],[0.50620445, 0.50034573, 0.50095868, 0.50126516, 0.54494843, 0.56242173, 0.57989504, 0.58863169, 0.59352915, 0.62291388, 0.62781133, 0.61475167, 0.5821025, 0.57557266, 0.55823061, 0.54955958, 0.5235465],[0.57557266, 0.60822183, 0.6212815, 0.62781133, 0.63674485, 0.64567836, 0.66354539, 0.66425234, 0.66849401, 0.6699079, 0.67061484, 0.66503747, 0.64830535, 0.62898567, 0.609666, 0.60540433, 0.58835766],[0.55672681, 0.52600551, 0.50296454, 0.49528421, 0.5040204, 0.50620445, 0.56690164, 0.57557266, 0.584096, 0.60114267, 0.609666, 0.6030486, 0.57657901, 0.56334421],[0.51272533, 0.53066806, 0.56655352, 0.57112763, 0.58484995, 0.60314637, 0.61229458, 0.57851103, 0.5362816, 0.52783572, 0.51094394, 0.49848465, 0.48602536, 0.49270035, 0.50938783],[0.62781133, 0.58863169, 0.59534324, 0.61547789, 0.62218944, 0.63454881, 0.64690818, 0.66253885, 0.68598485, 0.69380018, 0.69627632, 0.70370473, 0.71360927, 0.66980338, 0.66354539, 0.65461188],[0.50126516, 0.49597512, 0.49068508, 0.49574979, 0.50841158, 0.51094394, 0.54472749, 0.58695692, 0.60384869, 0.61229458, 0.62218944, 0.61883367, 0.59869902, 0.59198747, 0.58863169, 0.52747512, 0.51000181],[0.56655352, 0.62082999, 0.64362604, 0.67402077, 0.68161945, 0.68809603, 0.65102697, 0.64690818, 0.6407285, 0.62218944, 0.61229458, 0.60772047, 0.57570173],[0.62082999, 0.59949129, 0.61133367, 0.64686081, 0.66227481, 0.70851679, 0.71291052, 0.71583967, 0.71730424, 0.71135678, 0.68161945, 0.6588234, 0.63602736],[0.62082999, 0.61540235, 0.57740882, 0.56655352, 0.54861079, 0.53963943, 0.51272533, 0.49276021, 0.49657948, 0.50612767, 0.50803731, 0.52687111, 0.55410368, 0.59041377, 0.59949129],[0.62892946, 0.54361826, 0.54098268, 0.53044039, 0.53894006, 0.56443904, 0.63243632, 0.63605807, 0.63625394, 0.63644981, 0.63782088, 0.63840848],[0.54502615, 0.52687111, 0.52517659, 0.52432934, 0.53879603, 0.54361826, 0.58153434, 0.61945043, 0.63840848, 0.64162147, 0.64483445, 0.64517218, 0.64550991, 0.64652309, 0.64686081, 0.64093962, 0.60541248, 0.59949129, 0.58133625],[0.74036235, 0.80051238, 0.80813602, 0.83100692, 0.84625418, 0.84962016, 0.8597181, 0.84943335, 0.83400622, 0.82886384, 0.82039761, 0.78653265, 0.77806642, 0.77080691, 0.7562879, 0.7490284],[0.73179957, 0.74036235, 0.7418067, 0.74325104, 0.7490284, 0.73994595, 0.69453368, 0.68545122, 0.64003895, 0.63731573, 0.63459252, 0.63896808, 0.64115586, 0.65209477, 0.6608459, 0.67186004, 0.69754841],[0.76146482, 0.74621228, 0.74090026, 0.73824425, 0.73027623, 0.75895034, 0.7732874, 0.77806642, 0.79499889, 0.82886384, 0.8381711, 0.84127351, 0.83701713, 0.82850436, 0.80722243, 0.79196989],[0.7490284, 0.77806642, 0.74461329, 0.73505525, 0.73027623, 0.7145732, 0.63605807, 0.63424719, 0.63243632, 0.63813829, 0.64003895, 0.66728631],[0.74036235, 0.67186004, 0.67673892, 0.68324409, 0.68487039, 0.70318016, 0.77641925, 0.79472902, 0.79617486, 0.80051238, 0.78246738, 0.74637736],[0.68487039, 0.67777073, 0.67923042, 0.68214981, 0.68360951, 0.70042689, 0.76769643, 0.78451382, 0.7979982, 0.81148259, 0.82496697, 0.79775282, 0.79472902, 0.78557413, 0.71233505],[0.77911869, 0.76546729, 0.7464968, 0.73701155, 0.67061484, 0.66778706, 0.66354539, 0.68231934, 0.70735128, 0.71360927, 0.76267622, 0.76473153, 0.76884215],[0.82496697, 0.79125601, 0.78451382, 0.782133, 0.77499055, 0.76546729, 0.76888014, 0.77911869, 0.78886528, 0.80835846, 0.85709141, 0.88633117, 0.89607776, 0.89003978, 0.86588784, 0.85984985, 0.85112913],[0.68360951, 0.67919649, 0.65713139, 0.64830535, 0.65388272, 0.67061484, 0.72752631, 0.76546729, 0.76784811, 0.77975219, 0.78451382, 0.77610513, 0.70883559],[0.71968637, 0.78008749, 0.79655302, 0.82948407, 0.8459496, 0.84613922, 0.82527347, 0.76267622, 0.75449839, 0.72178709, 0.71360927, 0.71113313, 0.69875245, 0.69380018],[0.77782775, 0.78598518, 0.78303634, 0.78008749, 0.77145876, 0.74557257, 0.72831511, 0.70242891, 0.69380018, 0.65472351, 0.64690818, 0.65926453, 0.67573967, 0.68397724, 0.68809603, 0.72072575],[0.70851679, 0.71975783, 0.74786044, 0.75348096, 0.76749735, 0.79553012, 0.79720821, 0.79888629, 0.80392053, 0.7952589, 0.78659728, 0.75195076, 0.72596587, 0.71730424, 0.70998136],[0.80392053, 0.81019419, 0.80414331, 0.80051278, 0.79688088, 0.78598518, 0.72888318, 0.68809603, 0.68647688, 0.68323859, 0.68161945, 0.68756691, 0.69351438, 0.71730424, 0.77793565],[0.75348096, 0.7382924, 0.74225234, 0.74621228, 0.75383855, 0.78434362, 0.80722243, 0.8285701, 0.84458085, 0.8605916, 0.83619355, 0.80366281, 0.79553012, 0.78852193],[0.64686081, 0.64483445, 0.67287184, 0.71025502, 0.71960081, 0.7382924, 0.74082383, 0.74335526, 0.75094954, 0.75348096, 0.73099888, 0.70851679, 0.6853958, 0.6699818],[0.64483445, 0.63840848, 0.63801674, 0.63723327, 0.63605807, 0.6517611, 0.66746412, 0.70672169, 0.73027623, 0.73293224, 0.74621228, 0.7382924, 0.66352604, 0.65418025],[0.93445916, 0.92407434, 0.91579425, 0.89923409, 0.84127351, 0.82886384, 0.8597181, 0.88778381, 0.95327047, 0.96456103, 0.96539373, 0.96622643, 0.96093189, 0.94240098],[1.02865975, 0.97213939, 0.93445916, 0.9397537, 0.95828461, 0.96622643, 0.98121115, 1.03365765, 1.04864237, 1.05613472, 1.05756546, 1.0589962, 1.05394013, 1.03371583],[1.04828584, 1.03154088, 0.97293351, 0.96456103, 0.95891575, 0.95327047, 0.95310789, 0.95131954, 1.00075626, 1.00781865, 1.01417705, 1.03325223, 1.04264824],[0.91402906, 0.92155961, 0.93643958, 0.95131954, 0.9516447, 0.95180728, 0.95245759, 0.95294532, 0.95327047, 0.94391523, 0.90649428, 0.89713905, 0.8597181, 0.85803511, 0.84793717, 0.84625418, 0.88390689],[0.91521387, 0.95729336, 0.96251748, 0.98863808, 1.00431044, 1.00953455, 1.0086766, 1.00781865, 0.9795691, 0.95131954, 0.92899959, 0.92155961, 0.91752417, 0.90138243, 0.87313438, 0.88155028],[0.85378473, 0.84625418, 0.80051238, 0.7976207, 0.79472902, 0.80984799, 0.81589558, 0.82194317, 0.82496697, 0.84240841, 0.85984985, 0.86649212, 0.87313438, 0.87716982, 0.88927613, 0.92155961],[0.81831822, 0.84613922, 0.85301496, 0.90114509, 0.92177229, 0.92864802, 0.92749371, 0.92691655, 0.92518507, 0.91790825, 0.90335459, 0.89607776, 0.87658458, 0.77911869, 0.77089745, 0.76267622],[0.97373015, 0.98586642, 0.96443663, 0.95729336, 0.94887746, 0.93204567, 0.87313438, 0.85984985, 0.86286884, 0.88702078, 0.89607776, 0.91063142, 0.92518507, 0.93732134, 0.94338948],[0.88871078, 0.8459496, 0.80753003, 0.78008749, 0.78156191, 0.78598518, 0.78961708, 0.80051278, 0.89949451, 0.90209701, 0.9029645],[0.92864802, 0.84613922, 0.8459496, 0.85070084, 0.87920829, 0.88395953, 0.9029645, 0.95011178, 0.9815433, 0.98596096, 0.98816979, 0.99037861, 0.98500829, 0.9769528, 0.97426763, 0.9590611],[0.9029645, 0.89949451, 0.90682371, 0.91415291, 0.93910396, 0.97237204, 0.9973231, 1.00555025, 1.02200456, 1.03023171, 0.98560067, 0.9815433, 0.95796966],[0.98068906, 0.91415291, 0.91126489, 0.90260085, 0.8910488, 0.88816079, 0.88527278, 0.89018721, 0.91475939, 0.92458827, 0.93809327, 0.95835076, 0.96510326, 0.96832525, 0.9779912, 0.9973231],[0.89949451, 0.89124603, 0.82525821, 0.81700973, 0.80051278, 0.80172295, 0.80777383, 0.81019419, 0.84773348, 0.87588795, 0.88527278, 0.89393682, 0.91415291, 0.90315911],[0.93445916, 0.98155945, 1.02865975, 1.02992108, 1.03244373, 1.03496638, 1.0362277, 1.01156377, 0.95401461, 0.92935068, 0.92112937, 0.91554377, 0.90437258, 0.89878699, 0.90131572, 0.90637319, 0.91648813, 0.9215456, 0.92407434],[0.81019419, 0.80392053, 0.79636916, 0.79553012, 0.81179549, 0.85245891, 0.8605916, 0.87014045, 0.89878699, 0.92112937, 0.92458827, 0.90001609, 0.88527278, 0.81957901],[0.81999158, 0.84127351, 0.85783368, 0.86611376, 0.92407434, 0.91901687, 0.90384446, 0.89878699, 0.87968929, 0.8605916, 0.84991776, 0.81255934, 0.80722243, 0.81147881]]


# compute robust convex hull of each grain
# doesn't work for concave grains
x = []
y = []
for i in range(len(s)):
    points = np.c_[s[i], t[i]]
    idxs = compute_hull(points)
    x.append(np.array(s[i])[idxs])
    y.append(np.array(t[i])[idxs])


unique_x = []
unique_y = []
polygons = []
bins = []

node_to_face = {}


for i in range(len(x)):
    polygons.append([])
    for j in range(len(x[i])):
        flag_new = True
        id = -1

        for k in range(len(unique_x)):
            if np.hypot(unique_x[k] - x[i][j], unique_y[k] - y[i][j]) < 1e-6:
                flag_new = False
                bins[k] += 1
                id = k
                break

        if flag_new:
            id = len(unique_x)
            bins.append(1)
            unique_x.append(x[i][j])
            unique_y.append(y[i][j])

        polygons[i].append(id)
    

unique_x = np.array(unique_x)
unique_y = np.array(unique_y)
bins = np.array(bins)


n_dt = 275  # number of time steps
coords_x = np.tile(unique_x, (n_dt, 1))
coords_y = np.tile(unique_y, (n_dt, 1))

# store the nodes and polygons
np.savetxt('nodes_x.txt', coords_x, delimiter=' ', fmt='%.3e')
np.savetxt('nodes_y.txt', coords_y, delimiter=' ', fmt='%.3e')
with open('polygons.txt', 'w') as f:
    for i in range(len(polygons)):
        for j in range(len(polygons[i])):
            f.write(str(polygons[i][j]) + ' ')
        f.write('\n')


# plot the grains
for i in range(len(x)):
    plt.plot(x[i], y[i], '-')
plt.plot(unique_x, unique_y, '.', color='C0')
plt.show()


# store the angles of the grains
# with open('angles.txt', 'w') as f:
#     for i in range(len(o)):
#         for j in range(len(o[i])):
#             f.write(f"{o[i][j]:.3f} ")
#         f.write("\n")
